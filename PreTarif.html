<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Цены 30 янв</title>
	<style>
		body{font-family:Arial,sans-serif;margin:10px 10px 10px 10px;padding:10px;border:1px solid #ccc;border-radius:8px;max-width:280px;background-color:white;color:black;margin-top:8px}.question{margin-bottom:20px}.result{font-weight:bold;margin-top:15px}@media (prefers-color-scheme: dark){body{background-color:#333;color:white;border-color:#555}}@media (max-width:295px){body{font-size:13px}}@media (min-width:550px){body{margin:10px 10px 10px 10px;margin-top:8px}}@media (max-width:550px){body{margin:10px auto 10px auto}}
		.back-button{display:block;margin:8px auto 0;color:#007BFF;text-decoration:underline;cursor:pointer;text-align:center;}
		.back-button2{display:block;color:#007BFF;text-decoration:underline;cursor:pointer}
		.back-button2:hover{color:#0056b3;}
		.back-button:hover{color:#0056b3;}
		footer { position: relative; top: 4px; text-align: center; color: gray; font-size: 12px;}
		label img { filter: drop-shadow(0 0 5px white); }
		.tooltip, .tooltip-motivation { position: absolute; background: #f0f0f0; color: black; padding: 8px 16px; border-radius: 4px; font-size: 14px; opacity: 0; visibility: hidden; transition: opacity 0.5s, visibility 0.5s; z-index: 1000; border: 1px solid #ccc; white-space: pre-line; user-select: none; cursor: default; }
		@media (prefers-color-scheme: dark) { .tooltip, .tooltip-motivation { background: #404040; color: white; border: 1px solid #555; } }
		.tooltip.show, .tooltip-motivation.show { opacity: 1; visibility: visible; }
		
		.spoiler{margin:8px 0 0;padding:0;width:100%}
		.spoiler-header{display:flex;justify-content:space-between;align-items:center;cursor:pointer;font-weight:700;color:#333;padding:8px;background:#eaeaea;border-radius:4px;margin-bottom:0px}
		.spoiler-content{max-height:0;overflow:hidden;transition:max-height .2s ease-out;padding:0;width:100%;margin:0}
		.spoiler-footer{text-align:right;font-size:.9em;color:#666;opacity:0;transition:opacity .2s ease-out;margin:0;cursor:pointer}
		.spoiler-footer.show{opacity:1; padding-bottom: 10px;}
		.spoiler-icon{font-size:1.2em;margin-left:auto;transition: transform .2s ease}
		.spoiler-icon.rotate {transform: rotate(180deg);}
		.price{float:right;position:relative;top:8px;white-space:nowrap}
		.price2{float:right;position:relative;top:0px;white-space:nowrap}
		.price3{float:right;position:relative;top:-16px;white-space:nowrap}
		.smile{font-size: 13px;}

		@media (prefers-color-scheme: dark){ .spoiler-header{background:#555;color:#eee} .spoiler-footer{color:#aaa } }
		
		#tooltip2 { position: absolute; background: #f0f0f0; color: black; border-radius: 4px; border: 1px solid #ccc; padding: 6px 8px; z-index: 1000; opacity: 0; visibility: hidden; transition: opacity 0.5s, visibility 0.5s; user-select: none; cursor: default; }
		@media (prefers-color-scheme: dark) { #tooltip2 { background: #404040; color: white; border: 1px solid #555; } }
		#tooltip2.show { opacity: 1; visibility: visible; }
		#tooltip2 p { margin: 7px 0; }
	</style>

</head>
<body>

<div class="question">
    <label>Выберите тариф:</label><br>
    <input type="radio" name="tariff" value="850" id="tariff1" data-discount="6" data-discount2="425" checked>
    <label for="tariff1">1:&#160&#160&#160: 650 мин, 30 Гб, 100 SMS</label><br>
	
	<input type="radio" name="tariff" value="890" id="tariff112" data-discount="13" data-discount2="712">
    <label for="tariff112">112: 650 мин, 30 Гб, 100 SMS</label><br>
	
	<input type="radio" name="tariff" value="1050" id="tariff7" data-discount="6" data-discount2="525">
    <label for="tariff7">7&#160&#160&#160&#160: 1200 мин, 50 Гб, 50 SMS</label><br>
    
    <input type="radio" name="tariff" value="950" id="tariff2" data-discount="12" data-discount2="780">
    <label for="tariff2"><s>2&#160&#160&#160&#160: 500 мин, 35 Гб, 100 SMS</s></label><br>
    
    <input type="radio" name="tariff" value="650" id="tariff3" data-discount="0" data-discount2="650">
    <label for="tariff3">3&#160&#160: 0 мин, 1 раз 30 Гб, 0 SMS</label><br>
    
    <input type="radio" name="tariff" value="1090" id="tariff4" data-discount="12" data-discount2="950">
    <label for="tariff4"><s>4&#160&#160&#160&#160: 1200 мин, 50 Гб, 50 SMS</s></label>
</div>



<div class="question">
    <label>Покупка и Рассрочки:</label><br>
    
    <input type="checkbox" name="buyRouter" value="1700" id="buyRouterYes" data-installments2="300" >
	<label for="buyRouterYes">Б/У&#160&#160&#160<img src="https://i124.fastpic.org/big/2025/0117/28/762e5750611a2a37ee976a2b79745728.png" alt="" width="30" height="30"> <small>5G - 1700</small></label> <input type="checkbox" name="Router" value="100" id="router" data-installments="2"><label for="router"><small>100</small></label><br>
	
	<input type="checkbox" name="buyBox" value="5000" id="buyBoxYes2" data-installments2="500" onclick="checkCheckboxes2(event, 'buyBoxYes2')"><label for="buyBoxYes2"> НОВ  <img src="https://i124.fastpic.org/big/2025/0117/f9/47c29a3393e81719fbd29505cfccaff9.png " alt="" width="30" height="19" />&#160&#160&#160&#160&#160<small> - 5000</small></label>&#160<input type="checkbox" name="buyBox3" value="250" id="buyBoxYes3" data-installments="2" data-installments2="500" onclick="checkCheckboxes2(event, 'buyBoxYes3')"><label for="buyBoxYes3"><small>250</small></label>
	</div>

<div class="spoiler">
    <div class="spoiler-header" onclick="toggleSpoiler(this)">
        <span>Нет на складе</span>
        <span class="spoiler-icon">+</span>
    </div>
		<div class="spoiler-content">
			<div class="question">
				<input type="checkbox" name="buyRouter2" value="3600" id="buyRouterYes2" data-installments2="500" >
				<label for="buyRouterYes2">НОВ <img src="https://i124.fastpic.org/big/2025/0117/28/762e5750611a2a37ee976a2b79745728.png" alt="" width="30" height="30" > <small>5G - 3600</small></label>
				<input type="checkbox" name="WiFi6" value="100" id="WiFi6_1" data-installments="3"><label for="WiFi6_1"><small>100</small></label>
				<input type="checkbox" name="WiFi6" value="295" id="WiFi6_2" data-installments="1"><label for="WiFi6_2"><small>295</small></label><br>

				<input type="checkbox" name="buyRouter3" value="5400" id="buyRouterYes3" data-installments2="500">
				<label for="buyRouterYes3">НОВ <img src="https://i124.fastpic.org/big/2025/0117/28/762e5750611a2a37ee976a2b79745728.png" alt="" width="30" height="30"> <small>6G - 5400</small></label>&#160<input type="checkbox" name="WiFi6" value="450" id="WiFi6" data-installments="1" data-installments2="500"><label for="WiFi6"><small>450</small></label><br>

				<input type="checkbox" name="buyBox" value="1999" id="buyBoxYes" data-installments2="300" onclick="checkCheckboxes2(event, 'buyBoxYes')">
				<label for="buyBoxYes">Б/У&#160&#160&#160<img src="https://i124.fastpic.org/big/2025/0117/f9/47c29a3393e81719fbd29505cfccaff9.png" alt="" width="30" height="19" /> <small>&#160&#160&#160&#160&#160- 1999</small></label> <input type="checkbox" name="WiFi6" value="100" id="buyBoxYes4" data-installments="2" data-installments2="300" onclick="checkCheckboxes2(event, 'buyBoxYes4')"><label for="buyBoxYes4"><small>100</small></label>
			</div>
		</div>
    <div class="spoiler-footer" onclick="toggleSpoiler(this.parentElement.querySelector('.spoiler-header'))">
        [свернуть]
    </div>
</div>

<div class="question">
    <label>Группа семья <small>(450/100 + 250)</small></label><br>
    <input type="radio" name="family" value="0" id="family0" checked>
    <label for="family0">0</label>
    <input type="radio" name="family" value="250" id="family1">
    <label for="family1">1</label>
    <input type="radio" name="family" value="500" id="family2">
    <label for="family2">2</label>
    <input type="radio" name="family" value="750" id="family3">
    <label for="family3">3</label>
    <input type="radio" name="family" value="1000" id="family4">
    <label for="family4">4</label><br>
	<small>(900 на все MNP, остается 550)</small>
</div>

<div class='result'>
	<hr>
    <h3>1 месяц : <span id='OneFinalPrice'>0</span> руб</h3>
    <h3>в месяц : <span id='finalPrice'>0</span> руб</h3>
    <h3><span id='discountEndDate'></span><span id='totalPrice'>0</span></h3>
	<h3><span id="installmentsResult"></span></h3>
</div>

<hr>
<div class="back-button"onclick="window.location.href='https://polix.pro/FullTarif'">Открыть таблицу тарифов</div>
<div class="back-button"onclick="window.location.href='https://urmdf.ssl.mts.ru/orders'">Открыть дилерский портал</div><br>

<div class="spoiler">
    <div class="spoiler-header" onclick="toggleSpoiler(this)">
        <span>Сервисы Зелёная точка</span>
        <span class="spoiler-icon">+</span>
    </div>
		<div class="spoiler-content">
			<div class="question">
				<small>
					<input type="checkbox" name="serviceRouterBuy" value="2200" id="serviceRouterBuy" onclick="checkCheckboxes2(event, 'serviceRouterBuy')">
					<label for="serviceRouterBuy">Покупка роутера б/у 5 Ггц<span class="price">- 2200</span></label>
				</small><br>

				<small>
					<input type="checkbox" name="serviceSetTopBoxBuy" value="4300" id="serviceSetTopBoxBuy" onclick="checkCheckboxes2(event, 'serviceSetTopBoxBuy')">
					<label for="serviceSetTopBoxBuy">Покупка приставки зефир<span class="price">- 4300</span></label>
				</small><br>
			</div>

			<div class='result'>
				<h3><span id="ServisPrise2"></span></h3>
			</div>

			<div class="question">
				<small>
					<input type="checkbox" name="serviceRouterRent" value="120" id="serviceRouterRent" onclick="checkCheckboxes2(event, 'serviceRouterRent')">
					<label for="serviceRouterRent">Аренда роутера / Приставки<span class="price">- 120</span></label>
				</small><br>
					<div class='result'>
						<h3><span id="ServisPrise4"></span></h3>
					</div>
				<small>
					<input type="checkbox" name="serviceDeviceInstall" value="300" id="serviceDeviceInstall" onclick="checkCheckboxes2(event, 'serviceDeviceInstall')">
					<label for="serviceDeviceInstall">Уст дополнительных устройств<span class="price">- 300</span></label>
				</small><br>

				<small>
					<input type="checkbox" name="serviceRemoteReplace" value="800" id="serviceRemoteReplace" onclick="checkCheckboxes2(event, 'serviceRemoteReplace')">
					<label for="serviceRemoteReplace">Замена пульта, блока питания<span class="price">- 800</span></label>
				</small><br>

				<small>
					<input type="checkbox" name="serviceEquipmentReplace" value="400" id="serviceEquipmentReplace" onclick="checkCheckboxes2(event, 'serviceEquipmentReplace')">
					<label for="serviceEquipmentReplace">Замена оборудки и комплект<span class="price">- 400</span></label>
				</small><br>

				<small>
					<input type="checkbox" name="serviceCableInstall" value="400" id="serviceCableInstall" onclick="checkCheckboxes2(event, 'serviceCableInstall')">
					<label for="serviceCableInstall">Прокладка кабеля по плинтусу<span class="price">- 400</span></label>
				</small>
			</div>

			<div class='result'>
				<h3><span id="ServisPrise"></span></h3>
				<h3><span id="ServisPrise3"></span></h3>
			</div>
		</div>
    <div class="spoiler-footer" onclick="toggleSpoiler(this.parentElement.querySelector('.spoiler-header'))">
        [свернуть]
    </div>
</div>

<div class="spoiler">
    <div class="spoiler-header" onclick="toggleSpoiler(this)">
        <span>Справка</span>
        <span class="spoiler-icon">+</span>
    </div>
		<div class="spoiler-content">
			<div class="smile">
				<p>Дабл (интернет и IPTV) <span class="price2">- 2017</span></p>
				<p>ШПД FTTB (только интернет) <span class="price2">- 1829</span></p>
				<p>Привлечение из ЗТ в МТС <span class="price2">- 1200</span></p>
				<hr>
				<p>Гарантия у нов оборудования <span class="price2">- год</span></p>
				<p>Гарантия у б/у оборудования <span class="price2">- пол года</span></p>
				<a class="back-button2" href="tel:+79167618888">+79167618888</a><span class="price3"> - поддержка систем МТС</span>
			</div>
		</div>
    <div class="spoiler-footer" onclick="toggleSpoiler(this.parentElement.querySelector('.spoiler-header'))">
        [свернуть]
    </div>
</div>

<footer>
	<small>Об ошибках сообщайте <a href="https://mi_0014.t.me" target="_blank" style="color: #6C8EBF;">@mi_0014</a>.</small>
</footer>

<div id="tooltip2">
    <p>Кол: 
        <button class="button" onclick="decreaseQuantity2()">-</button>
        <span id="quantityDisplay2">1</span> 
        <button class="button" onclick="increaseQuantity2()">+</button>
    </p>
    <p>Цена: <span id="costDisplay2">0</span></p>
    <button class="button confirm-button" onclick="confirmSelection2()">Закрыть окно</button>
</div>

<div id="tooltip" class="tooltip"></div>
<div id="tooltip-motivation" class="tooltip-motivation"></div>
<div id="tooltip-ok" class="tooltip"</div>

<script>
let quantities = {
    buyBoxYes2: 1,
    buyBoxYes3: 1,
    buyBoxYes: 1,
    buyBoxYes4: 1,
	serviceDeviceInstall: 1,
	serviceRouterRent: 1,
	serviceRemoteReplace: 1,
	serviceEquipmentReplace: 1,
	serviceCableInstall: 1,
	serviceRouterBuy: 1,
	serviceSetTopBoxBuy: 1
};

function calculateTotal() {
    const tariff = parseFloat(document.querySelector('input[name=tariff]:checked')?.value) || 0;
    const routerCheckbox = document.getElementById('router');
    const router = routerCheckbox.checked ? parseFloat(routerCheckbox.value) : 0;
    const WiFi6 = document.getElementById('WiFi6').checked ? parseFloat(document.getElementById('WiFi6').value) : 0;
    const WiFi6_1 = document.getElementById('WiFi6_1').checked ? parseFloat(document.getElementById('WiFi6_1').value) : 0;
    const WiFi6_2 = document.getElementById('WiFi6_2').checked ? parseFloat(document.getElementById('WiFi6_2').value) : 0;
    const buyRouter = document.getElementById('buyRouterYes').checked ? parseFloat(document.getElementById('buyRouterYes').value) : 0;
    const buyRouter2 = document.getElementById('buyRouterYes2').checked ? parseFloat(document.getElementById('buyRouterYes2').value) : 0;
    const buyRouter3 = document.getElementById('buyRouterYes3').checked ? parseFloat(document.getElementById('buyRouterYes3').value) : 0;
    const buyBox = document.getElementById('buyBoxYes').checked ? parseFloat(document.getElementById('buyBoxYes').value) * quantities.buyBoxYes : 0;
    const buyBox2 = document.getElementById('buyBoxYes2').checked ? parseFloat(document.getElementById('buyBoxYes2').value) * quantities.buyBoxYes2 : 0;
    const buyBox3 = document.getElementById('buyBoxYes3').checked ? parseFloat(document.getElementById('buyBoxYes3').value) * quantities.buyBoxYes3 : 0;
    const buyBox4 = document.getElementById('buyBoxYes4').checked ? parseFloat(document.getElementById('buyBoxYes4').value) * quantities.buyBoxYes4 : 0;
    const setTopBox = parseFloat(document.querySelector('input[name=setTopBox]:checked')?.value) || 0;
    const family = parseFloat(document.querySelector('input[name=family]:checked')?.value) || 0;
	const isFamilySelected = family !== 0;
	const additionalOneFinalPrice = isFamilySelected ? 480 : 0;
	const additionalTotalFinalPrice = isFamilySelected ? 100 : 0;
    const dataTariff2 = parseFloat(document.querySelector('input[name=setTopBox]:checked')?.getAttribute('data-tariff2')) || 0;
	const selectedSetTopBox = document.querySelector('input[name="setTopBox"]:checked');
	const buyBoxValues = [quantities.buyBoxYes2, quantities.buyBoxYes3, quantities.buyBoxYes, quantities.buyBoxYes4];
	const hasValueGreaterThanOne = buyBoxValues.some(value => value > 1);
	const multirum = (selectedSetTopBox?.value >= 240 || hasValueGreaterThanOne) ? 50 : 0;
    const selectedTariff = document.querySelector('input[name=tariff]:checked');
    const data_discount = parseInt(selectedTariff.getAttribute('data-discount')) || 0;
    const discountTarif = parseFloat(selectedTariff.getAttribute('data-discount2')) || 0;
    const serviceRouterBuy = document.getElementById('serviceRouterBuy').checked ? parseFloat(document.getElementById('serviceRouterBuy').value) * quantities.serviceRouterBuy : 0;
    const serviceSetTopBoxBuy = document.getElementById('serviceSetTopBoxBuy').checked ? parseFloat(document.getElementById('serviceSetTopBoxBuy').value) * quantities.serviceSetTopBoxBuy : 0;
	const serviceDeviceInstall = document.getElementById('serviceDeviceInstall').checked ? parseFloat(document.getElementById('serviceDeviceInstall').value) * quantities.serviceDeviceInstall : 0;
	const serviceRouterRent = document.getElementById('serviceRouterRent').checked ? parseFloat(document.getElementById('serviceRouterRent').value) * quantities.serviceRouterRent : 0;
	const serviceRemoteReplace = document.getElementById('serviceRemoteReplace').checked ? parseFloat(document.getElementById('serviceRemoteReplace').value) * quantities.serviceRemoteReplace : 0;
	const serviceEquipmentReplace = document.getElementById('serviceEquipmentReplace').checked ? parseFloat(document.getElementById('serviceEquipmentReplace').value) * quantities.serviceEquipmentReplace : 0;
	const serviceCableInstall = document.getElementById('serviceCableInstall').checked ? parseFloat(document.getElementById('serviceCableInstall').value) * quantities.serviceCableInstall : 0;

    const ServisPrise = serviceDeviceInstall + serviceRemoteReplace + serviceEquipmentReplace + serviceCableInstall;
	const ServisPrise2 = serviceRouterBuy + serviceSetTopBoxBuy + serviceRouterRent;
	const ServisPrise4 = serviceRouterRent;

	const bothRouterAndSetTopBox = serviceRouterBuy > 0 && serviceSetTopBoxBuy > 0;
	const onlyRouterAndSetTopBox = bothRouterAndSetTopBox &&
		serviceDeviceInstall === 0 &&
		serviceRemoteReplace === 0 &&
		serviceEquipmentReplace === 0 &&
		serviceCableInstall === 0;
		
	document.getElementById('ServisPrise4').innerText = ServisPrise4 === 0 ? "" : `Аренда : ${ServisPrise4} руб`;

	if (onlyRouterAndSetTopBox) {
		document.getElementById('ServisPrise').innerText = "";
		document.getElementById('ServisPrise2').innerText = `Итого покупка: ${ServisPrise2} руб`;
	} else {
		document.getElementById('ServisPrise').innerText = ServisPrise > 600 ? `Сервисы : ${ServisPrise} руб` : "";

		if (bothRouterAndSetTopBox) {
			document.getElementById('ServisPrise2').innerText = `Итого покупка : ${ServisPrise2} руб`;
		} else {
			document.getElementById('ServisPrise2').innerText = "";
		}
	}

	const ServisPrise3 = ServisPrise + ServisPrise2;
	document.getElementById('ServisPrise3').innerText = (ServisPrise === 0 || ServisPrise2 === 0) ? "" : `1 оплата : ${ServisPrise3} руб`;

    let OneFinalPrice, totalPrice, finalPrice;

    if (selectedTariff.id === 'tariff3') {
        OneFinalPrice = discountTarif + router + buyRouter + buyRouter2 + buyRouter3 + WiFi6 + WiFi6_1 + WiFi6_2 + 150;
        totalPrice = tariff + router + WiFi6 + WiFi6_1 + WiFi6_2;
        finalPrice = discountTarif + router + WiFi6 + WiFi6_1 + WiFi6_2;

    } else if (selectedTariff.id === 'tariff2' || selectedTariff.id === 'tariff4') {
        OneFinalPrice = discountTarif + router + buyRouter + buyRouter2 + buyRouter3 + buyBox + WiFi6 + WiFi6_1 + WiFi6_2 + buyBox2 + buyBox3 + buyBox4 + dataTariff2 + family + additionalOneFinalPrice + 150;
        totalPrice = tariff + router + dataTariff2 + WiFi6 + WiFi6_1 + WiFi6_2 + family + buyBox3 + buyBox4 + additionalTotalFinalPrice;
        finalPrice = discountTarif + router + dataTariff2 + WiFi6 + WiFi6_1 + WiFi6_2 + family + buyBox3 + buyBox4 + additionalTotalFinalPrice;

    } else {
        OneFinalPrice = discountTarif + router + buyRouter + buyRouter2 + buyRouter3 + buyBox + WiFi6 + WiFi6_1 + WiFi6_2 + buyBox2 + buyBox3 + buyBox4 + setTopBox + family + additionalOneFinalPrice + 150;
        totalPrice = tariff + router + setTopBox + buyBox3 + buyBox4 + WiFi6 + WiFi6_1 + WiFi6_2 + family + additionalTotalFinalPrice;
        finalPrice = discountTarif + router + setTopBox + buyBox3 + buyBox4 + WiFi6 + WiFi6_1 + WiFi6_2 + family + additionalTotalFinalPrice;
    }

    document.getElementById('OneFinalPrice').innerText = OneFinalPrice.toFixed(0);
    document.getElementById('finalPrice').innerText = finalPrice.toFixed(0);

    if (totalPrice === finalPrice) {
        document.getElementById('totalPrice').innerText = "";
    } else {
        document.getElementById('totalPrice').innerText = totalPrice.toFixed(0) + " руб";
    }

    const discountEndDateElement = document.getElementById('discountEndDate');

    function getDynamicEndDate(data_discount) {
        const startDate = new Date();
        startDate.setMonth(startDate.getMonth() + data_discount);

        const nextDay = new Date(startDate);
        nextDay.setDate(startDate.getDate() + 1);

        const dayOfWeek = nextDay.getDay();
        if (dayOfWeek === 5) {
            nextDay.setDate(nextDay.getDate() + 2);
        } else if (dayOfWeek === 6) {
            nextDay.setDate(nextDay.getDate() + 1);
        }

        return nextDay;
    }

	function calculateInstallments(totalPrice, router, buyBox3, buyBox4, WiFi6, WiFi6_1, WiFi6_2) {
		const installmentsCheckboxes = document.querySelectorAll('input[type=checkbox][data-installments]');
		let dataInstallments = 0;

		const isThirdTariff = document.getElementById('tariff3').checked;

		installmentsCheckboxes.forEach(checkbox => {
			if (checkbox.checked) {
				const installmentsValue = parseFloat(checkbox.getAttribute('data-installments')) || 0;
				if (installmentsValue > dataInstallments) {
					dataInstallments = installmentsValue;
				}
			}
		});

		let yearWord;
		if (dataInstallments === 1) {
			yearWord = "год";
		} else if (dataInstallments === 2 || dataInstallments === 3 || dataInstallments === 4) {
			yearWord = "года";
		} else {
			yearWord = "года";
		}

		if (isThirdTariff) {

			if (router || WiFi6 || WiFi6_1 || WiFi6_2) {
				return `через ${dataInstallments} ${yearWord} : ${totalPrice - router - WiFi6 - WiFi6_1 - WiFi6_2} руб`;
			} else {
				return "";
			}
		} else {

			if (router || buyBox3 || buyBox4 || WiFi6 || WiFi6_1 || WiFi6_2) {
				return `через ${dataInstallments} ${yearWord} : ${totalPrice - buyBox3 - buyBox4 - router - WiFi6 - WiFi6_1 - WiFi6_2} руб`;
			} else {
				return "";
			}
		}
	}

    const installmentsResult = calculateInstallments(totalPrice, router, buyBox3, buyBox4, WiFi6, WiFi6_1, WiFi6_2);
    document.getElementById('installmentsResult').textContent = installmentsResult;
	
    if (data_discount === 0) {
        discountEndDateElement.innerText = "";
    } else {
        const endDate = getDynamicEndDate(data_discount);

        const options = { day: '2-digit', month: '2-digit', year: 'numeric' };
        const formattedDate = endDate.toLocaleDateString('ru-RU', options);

        discountEndDateElement.innerText = `с ± ${formattedDate} : `;
    }
}

function showTooltip2(event, checkboxId) {
    currentCheckboxId = checkboxId;
    const tooltip2 = document.getElementById('tooltip2');
    tooltip2.style.display = 'block';

    const tooltipWidth = tooltip2.offsetWidth;
    const tooltipHeight = tooltip2.offsetHeight;
    const windowWidth = window.innerWidth;
    const windowHeight = window.innerHeight;

    let left = event.pageX;
    let top = event.pageY - tooltipHeight;

    if (left + tooltipWidth > windowWidth) {
        left = event.pageX - tooltipWidth;
    }

    if (top < 0) {
        top = event.pageY;
    }

    tooltip2.style.left = left + 'px';
    tooltip2.style.top = top + 'px';
    updateTooltipContent2();
    
    setTimeout(() => {
        tooltip2.classList.add('show');
    }, 10);
}


function hideTooltip2() {
    const tooltip = document.getElementById('tooltip2');
    tooltip.classList.remove('show');
}

function increaseQuantity2() {
    if (quantities[currentCheckboxId] < 5) {
        quantities[currentCheckboxId]++;
        updateTooltipContent2();
        updateTotalPrice();
    }
}

function decreaseQuantity2() {
    if (quantities[currentCheckboxId] > 1) {
        quantities[currentCheckboxId]--;
        updateTooltipContent2();
        updateTotalPrice();
    }
}

function updateTooltipContent2() {
    const selectedValue = getSelectedValue(currentCheckboxId);
    document.getElementById('quantityDisplay2').textContent = quantities[currentCheckboxId];
    document.getElementById('costDisplay2').textContent = selectedValue * quantities[currentCheckboxId];
}

function getSelectedValue(checkboxId) {
    const checkbox = document.getElementById(checkboxId);
    return checkbox.checked ? parseFloat(checkbox.value) : 0;
}

function confirmSelection2() {
    hideTooltip2();
}

function updateTotalPrice() {
    const totalPrice = calculateTotal();
    const priceElement = document.getElementById('OneFinalPrice');
}

window.onclick = function(event) {
    const tooltip2 = document.getElementById('tooltip2');
    if (event.target == tooltip2 || tooltip2.contains(event.target)) {
        return;
    }
    hideTooltip2();
};

function checkCheckboxes2(event, checkboxId) {
    const checkbox = document.getElementById(checkboxId);
    
    if (checkbox.checked) {
        showTooltip2(event, checkboxId);
        event.stopPropagation();
        quantities[checkboxId] = 1;
        updateTooltipContent2();
        updateTotalPrice();
    } else {
        hideTooltip2();
        quantities[checkboxId] = 1;
        updateTotalPrice();
    }
}

document.addEventListener('DOMContentLoaded', function () {
    const tooltip = document.getElementById('tooltip');
    const tooltipMotivation = document.getElementById('tooltip-motivation');
	const tooltipOk = document.getElementById('tooltip-ok');

    function hideAllTooltips() {
        tooltip.classList.remove('show');
        tooltipMotivation.classList.remove('show');
		tooltipOk.classList.remove('show');
    }

    function showTooltip(element, content, tooltipElement, offsetY = 0) {
        const rect = element.getBoundingClientRect();
        tooltipElement.textContent = content;

        const tooltipOffsetY = 20;

        tooltipElement.style.top = `${rect.top + window.scrollY + offsetY + tooltipOffsetY}px`;
        tooltipElement.style.left = `${rect.left + window.scrollX}px`;
        tooltipElement.classList.add('show');
        
        setTimeout(hideAllTooltips, 3000);
		
		tooltipElement.onclick = function() {
        hideTooltip(tooltipElement);
    }
    }

	function checkMultirumTooltip() {
		// Получаем выбранный элемент setTopBox
		const selectedSetTopBox = document.querySelector('input[name="setTopBox"]:checked');

		// Получаем все чекбоксы buyBoxYes
		const buyBoxCheckboxes = document.querySelectorAll('input[id^="buyBoxYes"]');

		// Проверяем, есть ли хотя бы один чекбокс buyBoxYes, который выбран
		const isBuyBoxChecked = Array.from(buyBoxCheckboxes).some(checkbox => checkbox.checked);

		// Устанавливаем значение multirum в зависимости от условий
		let multirum = 0;

		// Проверяем условия: либо значение >= 240, либо выбран хотя бы один чекбокс
		if ((selectedSetTopBox?.value >= 240 && isBuyBoxChecked) || selectedSetTopBox?.value >= 240) {
			multirum = 50; // Устанавливаем значение 50 при выполнении хотя бы одного условия или их комбинации
		}

		// Проверяем, если multirum больше 0
		if (multirum > 0) {
			// Получаем выбранный тариф
			const selectedTariff = document.querySelector('input[name="tariff"]:checked');

			if (selectedTariff && (selectedTariff.id === 'tariff2' || selectedTariff.id === 'tariff4')) {
				// Исключение: Если выбран тариф 2 или 4, стоимость мультирум становится 0
				multirum = 0;
			}

			// Формируем сообщение для отображения
			const message = multirum === 0 
				? "Мультирум 0 руб" 
				: "Мультирум 50 руб";

			// Показываем подсказку
			showTooltip(selectedSetTopBox || document.body, message, tooltipOk);
		}
	}

	// Добавляем обработчики событий для чекбоксов и радиокнопок
	document.querySelectorAll('input[name="setTopBox"], input[id^="buyBoxYes"], input[name="tariff"]').forEach(input => {
		input.addEventListener('change', checkMultirumTooltip);
	});

    document.querySelectorAll('input[name="tariff"]').forEach(radio => {
        radio.addEventListener('click', function () {
            const value = parseFloat(radio.value) || 0;
            const data_discount = parseInt(radio.getAttribute('data-discount')) || 0;
            const discountTarif = parseFloat(radio.getAttribute('data-discount2')) || 0;
            const isThirdTariff = radio.id === 'tariff3';

            const message = isThirdTariff
                ? `Цена ${value} руб`
                : `Цена ${value} руб\nСкидка ${discountTarif} на ${data_discount} м.`;

            showTooltip(radio, message, tooltipMotivation);
        });
    });
	
	document.addEventListener('click', function (event) {
		if (!event.target.matches('input[type=checkbox]') && !event.target.matches('input[name="tariff"]') && !event.target.matches('input[name="setTopBox"]')) {
			hideAllTooltips();
		}
	});

    document.querySelectorAll('input[type=checkbox]').forEach(checkbox => {
        checkbox.addEventListener('click', function () {
            const rect = checkbox.getBoundingClientRect();
            const value = checkbox.value;
            const installments = checkbox.getAttribute('data-installments');
            const installments2 = checkbox.getAttribute('data-installments2');

            if (checkbox.checked) {
                if (installments) {
                    showTooltip(checkbox, `${value} на ${installments} г.`, tooltip);
                }

                if (installments2) {
                    showTooltip(checkbox, `Мотивация ${installments2}`, tooltipMotivation, installments ? 40 : 0);
                }
            } else {
                hideAllTooltips();
            }
        });
    });
});


const radioButtons = document.querySelectorAll('input[type=radio]');
radioButtons.forEach(radio => {
    radio.addEventListener('change', calculateTotal);
});

const checkboxes = document.querySelectorAll('input[type=checkbox]');
checkboxes.forEach(checkbox => {
    checkbox.addEventListener('change', calculateTotal);
});

function toggleSpoiler(header) {
    const spoiler = header.parentElement;
    const content = spoiler.querySelector('.spoiler-content');
    const footer = spoiler.querySelector('.spoiler-footer');
    const icon = header.querySelector('.spoiler-icon');

    if (content.classList.contains('show')) {
    content.style.maxHeight = content.scrollHeight + 'px';    
    icon.classList.remove('rotate');
    setTimeout(() => {
        content.style.maxHeight = '0';
    }, 2);
    
    content.classList.remove('show');
    footer.classList.remove('show');
    icon.textContent = '+';
	} else {
		content.style.maxHeight = content.scrollHeight + 'px';		
		icon.classList.add('rotate');
		content.classList.add('show');
		footer.classList.add('show');
		icon.textContent = '-';

		content.addEventListener('transitionend', () => {
			footer.scrollIntoView({
				behavior: 'smooth',
				block: 'end'
			});
		}, { once: true });
	}

    content.addEventListener('transitionend', () => {
        if (!content.classList.contains('show')) {
            content.style.maxHeight = null;
        } else {
            content.style.maxHeight = 'none';
        }
    }, { once: true });
}
calculateTotal();
</script>
</body>
	
</html>
