<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Цены 17 янв</title>
	<style>
		body {
			font-family: Arial, sans-serif;
			margin: 20px;
			padding: 20px;
			border: 1px solid #ccc;
			border-radius: 8px;
			max-width: 260px;
			background-color: white;
			color: black;
		}

		.question {
			margin-bottom: 20px;
		}

		.result {
			font-weight: bold;
			margin-top: 15px;
		}

		@media (prefers-color-scheme: dark) {
			body {
				background-color: #333;
				color: white;
				border-color: #555;
			}
		}

		@media (max-width: 324px) {
			body {
				font-size: 13px;
			}
		}
	</style>

</head>
<body>

<div class="question">
    <label>Выберите тариф:</label><br>
    <input type="radio" name="tariff" value="850" id="tariff1" data-discount="6" data-discount2="50" checked>
    <label for="tariff1"><b>1</b>: 650 мин, 30 Гб, 100 SMS</label><br>
	
	<input type="radio" name="tariff" value="890" id="tariff112" data-discount="13" data-discount2="20">
    <label for="tariff112"><b>112</b>: 650 мин, 30 Гб, 100 SMS</label><br>
	
	<input type="radio" name="tariff" value="1050" id="tariff7" data-discount="6" data-discount2="50">
    <label for="tariff7"><b>7</b>: 1200 мин, 50 Гб, 50 SMS</label><br>
    
    <input type="radio" name="tariff" value="950" id="tariff2" data-discount="12" data-discount2="20">
    <label for="tariff2"><s><b>2</b>: 500 мин, 35 Гб, 100 SMS</s></label><br>
    
    <input type="radio" name="tariff" value="650" id="tariff3" data-discount="0" data-discount2="0">
    <label for="tariff3"><b>3</b>: 0 мин, 1 раз 30 Гб, 0 SMS</label><br>
    
    <input type="radio" name="tariff" value="1090" id="tariff4" data-discount="12" data-discount2="12.84">
    <label for="tariff4"><s><b>4</b>: 1200 мин, 50 Гб, 50 SMS</s></label>
</div>

<div class="question">
    <label>Аренда 5 ггц роутера <small>(120 тол. ЗТ)</small></label><br>
    <input type="radio" name="router" value="99" data-tariff3="150" id="routerYes">
    <label for="routerYes">Да</label>
    <input type="radio" name="router" value="0" data-tariff3="0" id="routerNo" checked>
    <label for="routerNo">Нет. <b>Рассрочка позже</b></label>
</div>


<div class="question">
	<label>Аренда приставок:</label>
	<input type="radio" name="setTopBox" value="0" data-tariff2="0" id="setTopBoxNo" checked>
	<label for="setTopBoxNo">Нет</label><br>

	<input type="radio" name="setTopBox" value="120" data-tariff2="0" id="setTopBox1">
	<label for="setTopBox1">1 приставка <small>(120 / 0 для 2)</small></label><br>

	<input type="radio" name="setTopBox" value="240" data-tariff2="120" id="setTopBox2">
	<label for="setTopBox2">2 приставки <small>(240 / 120 для 2)</small></label><br>

	<input type="radio" name="setTopBox" value="360" data-tariff2="240" id="setTopBox3">
	<label for="setTopBox3">3 приставки <small>(360 / 240 для 2)</small></label><br>

	<input type="radio" name="setTopBox" value="480" data-tariff2="360" id="setTopBox4">
	<label for="setTopBox4">4 приставки <small>(480 / 360 для 2)</small></label><br>
</div>

<div class="question">
    <label>Покупка:</label><br>
    <a>Б/У Роутер 5G (1700)</a>
    <input type="checkbox" name="buyRouter" value="1700" id="buyRouterYes">
    <label for="buyRouterYes">Да</label><br>
	
	<a>Нов Роутер 5G (3600)</a>
    <input type="checkbox" name="buyRouter2" value="3600" id="buyRouterYes2">
    <label for="buyRouterYes2">Да</label><br>
    
    <a>Приставка (4300)</a>
    <input type="checkbox" name="buyBox" value="4300" id="buyBoxYes">
    <label for="buyBoxYes">Да</label>
</div>

<div class="question">
    <label>Группа семья <small>(450)</small></label><br>
	<a>(Беслпатно пол года для MNP)</a><br>
	<input type="radio" name="family" value="0" id="family0" checked>
    <label for="family0">0</label>
    <input type="radio" name="family" value="450" id="family1">
    <label for="family1">1</label>
	<input type="radio" name="family" value="900" id="family2">
    <label for="family2">2</label>
	<input type="radio" name="family" value="1350" id="family3">
    <label for="family3">3</label>
	<input type="radio" name="family" value="1800" id="family4">
    <label for="family4">4</label>
</div>

<div class='result'>
	<hr>
    <h3>1 месяц : <span id='OneFinalPrice'>0</span> руб</h3>
    <h3>в месяц : <span id='finalPrice'>0</span> руб</h3>
    <h3><span id='discountEndDate'></span><span id='totalPrice'>0</span></h3>
</div>

<script>
function calculateTotal() {
    const tariff = parseFloat(document.querySelector('input[name=tariff]:checked')?.value) || 0;
    const router = parseFloat(document.querySelector('input[name=router]:checked')?.value) || 0;
    const buyRouter = document.getElementById('buyRouterYes').checked ? parseFloat(document.getElementById('buyRouterYes').value) : 0;
	const buyRouter2 = document.getElementById('buyRouterYes2').checked ? parseFloat(document.getElementById('buyRouterYes2').value) : 0;
    const buyBox = document.getElementById('buyBoxYes').checked ? parseFloat(document.getElementById('buyBoxYes').value) : 0;
    const setTopBox = parseFloat(document.querySelector('input[name=setTopBox]:checked')?.value) || 0;
	const family = parseFloat(document.querySelector('input[name=family]:checked')?.value) || 0;
	const dataTariff3 = parseFloat(document.querySelector('input[name=router]:checked')?.getAttribute('data-tariff3')) || 0;
	const dataTariff2 = parseFloat(document.querySelector('input[name=setTopBox]:checked')?.getAttribute('data-tariff2')) || 0;
	const dataTariff7 = parseFloat(document.querySelector('input[name=setTopBox]:checked')?.getAttribute('data-tariff7')) || 0;
    const selectedTariff = document.querySelector('input[name=tariff]:checked');
    const data_discount = parseInt(selectedTariff.getAttribute('data-discount')) || 0;
    const data_discount2 = parseFloat(selectedTariff.getAttribute('data-discount2')) || 0;
    const discountTarif = tariff * (1 - (data_discount2 / 100));

    let OneFinalPrice, totalPrice, finalPrice;

	if (selectedTariff.id === 'tariff3') {
		OneFinalPrice = discountTarif + dataTariff3 + buyRouter + buyRouter2 + 150;
		totalPrice = tariff + dataTariff3;
		finalPrice = discountTarif + dataTariff3;
	} else if (selectedTariff.id === 'tariff2') {
		OneFinalPrice = discountTarif + router + buyRouter + buyRouter2 + buyBox + dataTariff2 + family + 150;
		totalPrice = tariff + router + dataTariff2 + family;
		finalPrice = discountTarif + router + dataTariff2 + family;
	} else if (selectedTariff.id === 'tariff7') {
		OneFinalPrice = discountTarif + router + buyRouter + buyRouter2 + buyBox + dataTariff7 + family + 150;
		totalPrice = tariff + router + dataTariff7 + family;
		finalPrice = discountTarif + router + dataTariff7 + family;
	} else {
		OneFinalPrice = discountTarif + router + buyRouter + buyRouter2 + buyBox + setTopBox + family + 150;
		totalPrice = tariff + router + setTopBox + family;
		finalPrice = discountTarif + router + setTopBox + family;
	}

    document.getElementById('OneFinalPrice').innerText = OneFinalPrice.toFixed(0);
    document.getElementById('finalPrice').innerText = finalPrice.toFixed(0);
    
	if (totalPrice === finalPrice) {
		document.getElementById('totalPrice').innerText = "";
	} else {
		document.getElementById('totalPrice').innerText = totalPrice.toFixed(0) + " руб";
	}
	
	const discountEndDateElement = document.getElementById('discountEndDate');
	
function getDynamicEndDate(data_discount) {
    const startDate = new Date();
    startDate.setMonth(startDate.getMonth() + data_discount);

    const nextDay = new Date(startDate);
    nextDay.setDate(startDate.getDate() + 1);

    const dayOfWeek = nextDay.getDay();
    if (dayOfWeek === 0 || dayOfWeek === 6) {
        nextDay.setDate(nextDay.getDate() + 1);
    }

    return nextDay;
}

if (data_discount === 0) {
    discountEndDateElement.innerText = "";
} else {
    const endDate = getDynamicEndDate(data_discount);
    
    const options = { day: '2-digit', month: '2-digit', year: 'numeric' };
    const formattedDate = endDate.toLocaleDateString('ru-RU', options);
    
    discountEndDateElement.innerText = `с ± ${formattedDate} : `;
}

}

const radioButtons = document.querySelectorAll('input[type=radio]');
radioButtons.forEach(radio => {
	radio.addEventListener('change', calculateTotal);
});

const checkboxes = document.querySelectorAll('input[type=checkbox]');
checkboxes.forEach(checkbox => {
    checkbox.addEventListener('change', calculateTotal);
});

calculateTotal();
</script>
</body>
</html>
